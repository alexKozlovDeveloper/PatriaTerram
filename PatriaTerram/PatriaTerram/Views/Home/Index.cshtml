@model PatriaTerram.Core.Models.Palette

@{
    ViewBag.Title = "Patria Terram";
}

<div class="map-container">
    <table>
        @for (int i = 0; i < Model.Width; i++)
        {
            <tr>
                @for (int j = 0; j < Model.Height; j++)
                {
                    <td>
                        <div class="map-cell">
                            @for (int k = 0; k < Model[i, j].Components.Count; k++)
                            {
                                int r = (int)(Model[i, j].Components[k].Terrain.ColorR + (Model[i, j].Components[k].Value - 128) / 2.5);
                                int g = (int)(Model[i, j].Components[k].Terrain.ColorG + (Model[i, j].Components[k].Value - 128) / 2.5);
                                int b = (int)(Model[i, j].Components[k].Terrain.ColorB + (Model[i, j].Components[k].Value - 128) / 2.5);
                                //Model[i, j].GetPointColor(out int r, out int g, out int b);

                                <div class="map-cell-item @Model[i, j].Components[k].Terrain.Name" style='background-color: rgb(@r, @g, @b);'><div class="map-cell-item-value">@Model[i, j].Components[k].Value</div></div>
                            }
                        </div>
                    </td>
                }
            </tr>
        }
    </table>
</div>

<div>
    layers: @Model.Depth

    @for (int i = 0; i < Model.Depth; i++)
    {
        <div class="layer-button" onclick="selectLeayer(@i)">Layer @i</div>
    }

    Terrains:

    @foreach (var item in PatriaTerram.Core.Models.Terrain.GetTerrains())
    {
        <div class="layer-button" onclick="selectTerain('@item.Key')">@item.Key</div>
    }

    <div onclick="hideAll()">
        Hide all
    </div>

    <div onclick="showAll()">
        Show all
    </div>

    <div onclick="showValue()">
        Show Value
    </div>
    <div onclick="hideValue()">
        Hide Value
    </div>

</div>

<script>


    function selectLeayer(layerId) {
        //debugger;

        var cells = $(".map-cell");

        for (var i = 0; i < cells.length; i++) {
            var items = $(cells[i]).find(".map-cell-item")

            for (var j = 0; j < items.length; j++) {

                if (j == layerId) {
                    $(items[j]).removeClass("hidden-cell-item")
                }
                else {
                    $(items[j]).addClass("hidden-cell-item")
                }

                var color = items[j].innerHTML;

                $(items[j]).css('background-color', 'rgb(' + color + ', ' + color + ', ' + color + ')');
            }
        }
    }

    function hideAll(i) {
        //debugger;

        $(".map-cell-item")
            .addClass("hidden-cell-item")
    }

    function showAll(i) {
        //debugger;

        $(".map-cell-item")
            .removeClass("hidden-cell-item")
    }
    //map-cell-item-value
    function selectTerain(name) {
        //debugger;
        hideAll();

        $("." + name)
            .removeClass("hidden-cell-item")
    }

    function hideValue() {

        $(".map-cell-item-value")
            .addClass("hidden-cell-item")
    }

    function showValue() {

        $(".map-cell-item-value")
            .removeClass("hidden-cell-item")
    }

</script>





